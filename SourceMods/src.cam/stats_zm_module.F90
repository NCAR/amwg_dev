!-----------------------------------------------------------------------
! $Id$
!===============================================================================
module stats_zm_module

  implicit none

  private ! Default Scope

  public :: stats_init_zm

  ! Constant parameters
  integer, parameter, public :: nvarmax_zm = 350  ! Maximum variables allowed

  contains

!-----------------------------------------------------------------------
  subroutine stats_init_zm( vars_zm,                    & ! intent(in)
                            l_error,                    & ! intent(inout)
                            stats_metadata, stats_zm )    ! intent(inout)

! Description:
!   Initializes array indices for stats_zm

! Note:
!   All code that is within subroutine stats_init_zm, including variable
!   allocation code, is not called if l_stats is false.  This subroutine is
!   called only when l_stats is true.

!-----------------------------------------------------------------------

    use constants_clubb, only: &
        fstderr ! Constant(s)

    use stats_type_utilities, only: &
        stat_assign ! Procedure

    use parameters_model, only: &
        hydromet_dim, & ! Variable(s)
        sclr_dim,     &
        edsclr_dim

    use array_index, only: &
        hydromet_list, & ! Variable(s)
        l_mix_rat_hm

    use stats_type, only: &
        stats ! Type

    use stats_variables, only: &
        stats_metadata_type

    implicit none

    ! External
    intrinsic :: trim

    !--------------------- Input Variable ---------------------
    character(len= * ), dimension(nvarmax_zm), intent(in) :: &
      vars_zm ! stats_zm variable names

    !--------------------- InOut Variables ---------------------      
    type (stats_metadata_type), intent(inout) :: &
      stats_metadata

    type (stats), target, intent(inout) :: &
      stats_zm

    logical, intent(inout) :: l_error

    !--------------------- Local Varables ---------------------
    integer :: tot_zm_loops

    integer :: hm_idx, hmx_idx, hmy_idx

    character(len=10) :: hm_type, hmx_type, hmy_type

    integer :: i, j, k

    character(len=50) :: sclr_idx

    !--------------------- Begin Code ---------------------

    ! The default initialization for array indices for stats_zm is zero (see module
    ! stats_variables)

    ! If any of the index arrays are allocated, then we have called this before
    ! to set up stats_metadata, so all we want to do is set stats_zm via stats_assign
    if ( .not. allocated(stats_metadata%ihydrometp2) ) then

      allocate( stats_metadata%ihydrometp2(1:hydromet_dim) )
      allocate( stats_metadata%iwphydrometp(1:hydromet_dim) )
      allocate( stats_metadata%irtphmp(1:hydromet_dim) )
      allocate( stats_metadata%ithlphmp(1:hydromet_dim) )
      allocate( stats_metadata%ihmxphmyp(1:hydromet_dim,1:hydromet_dim) )
      allocate( stats_metadata%iK_hm(1:hydromet_dim) )

      stats_metadata%ihydrometp2(:) = 0
      stats_metadata%iwphydrometp(:) = 0
      stats_metadata%irtphmp(:) = 0
      stats_metadata%ithlphmp(:) = 0
      stats_metadata%ihmxphmyp(:,:) = 0
      stats_metadata%iK_hm(:) = 0

      ! Allocate and then zero out passive scalar arrays on the stats_zm grid (fluxes,
      ! variances and other high-order moments)
      allocate( stats_metadata%isclrprtp(1:sclr_dim) )
      allocate( stats_metadata%isclrp2(1:sclr_dim) )
      allocate( stats_metadata%isclrpthvp(1:sclr_dim) )
      allocate( stats_metadata%isclrpthlp(1:sclr_dim) )
      allocate( stats_metadata%isclrprcp(1:sclr_dim) )
      allocate( stats_metadata%iwpsclrp(1:sclr_dim) )
      allocate( stats_metadata%iwp2sclrp(1:sclr_dim) )
      allocate( stats_metadata%iwpsclrp2(1:sclr_dim) )
      allocate( stats_metadata%iwpsclrprtp(1:sclr_dim) )
      allocate( stats_metadata%iwpsclrpthlp(1:sclr_dim) )
      allocate( stats_metadata%iwpedsclrp(1:edsclr_dim) )

      stats_metadata%isclrprtp(:)    = 0
      stats_metadata%isclrp2(:)      = 0
      stats_metadata%isclrpthvp(:)   = 0
      stats_metadata%isclrpthlp(:)   = 0
      stats_metadata%isclrprcp(:)    = 0
      stats_metadata%iwpsclrp(:)     = 0
      stats_metadata%iwp2sclrp(:)    = 0
      stats_metadata%iwpsclrp2(:)    = 0
      stats_metadata%iwpsclrprtp(:)  = 0
      stats_metadata%iwpsclrpthlp(:) = 0
      stats_metadata%iwpedsclrp(:)   = 0

    end if

    ! Assign pointers for statistics variables stats_zm using stat_assign

    tot_zm_loops = stats_zm%num_output_fields

    if ( any( vars_zm == "hydrometp2" ) ) then
       ! Correct for number of variables found under "hydrometp2".
       ! Subtract 1 from the loop size for each hydrometeor.
       tot_zm_loops = tot_zm_loops - hydromet_dim
       ! Add 1 for "hydrometp2" to the loop size.
       tot_zm_loops = tot_zm_loops + 1
    endif

    if ( any( vars_zm == "wphydrometp" ) ) then
       ! Correct for number of variables found under "wphydrometp".
       ! Subtract 1 from the loop size for each hydrometeor.
       tot_zm_loops = tot_zm_loops - hydromet_dim
       ! Add 1 for "wphydrometp" to the loop size.
       tot_zm_loops = tot_zm_loops + 1
    endif

    if ( any( vars_zm == "rtphmp" ) ) then
       ! Correct for number of variables found under "rtphmp".
       ! Subtract 1 from the loop size for each hydrometeor.
       tot_zm_loops = tot_zm_loops - hydromet_dim
       ! Add 1 for "rtphmp" to the loop size.
       tot_zm_loops = tot_zm_loops + 1
    endif

    if ( any( vars_zm == "thlphmp" ) ) then
       ! Correct for number of variables found under "thlphmp".
       ! Subtract 1 from the loop size for each hydrometeor.
       tot_zm_loops = tot_zm_loops - hydromet_dim
       ! Add 1 for "thlphmp" to the loop size.
       tot_zm_loops = tot_zm_loops + 1
    endif

    if ( any( vars_zm == "hmxphmyp" ) ) then
       ! Correct for number of variables found under "hmxphmyp".
       ! Subtract the number of overall covariances of two hydrometeors, which
       ! is found by:  (1/2) * hydromet_dim * ( hydromet_dim - 1 );
       ! from the loop size.
       tot_zm_loops = tot_zm_loops - hydromet_dim * ( hydromet_dim - 1 ) / 2
       ! Add 1 for "hmxphmyp" to the loop size.
       tot_zm_loops = tot_zm_loops + 1
    endif

    if ( any( vars_zm == "K_hm" ) ) then
       ! Correct for number of variables found under "K_hm".
       ! Subtract 1 from the loop size for each hydrometeor.
       tot_zm_loops = tot_zm_loops - hydromet_dim
       ! Add 1 for "K_hm" to the loop size.
       tot_zm_loops = tot_zm_loops + 1
    endif

     if ( any( vars_zm == "sclrprtp" ) ) then
       ! Correct for number of variables found under "sclrprtp".
       ! Subtract 1 from the loop size for each scalar.
       tot_zm_loops = tot_zm_loops - sclr_dim
       ! Add 1 for "sclrprtp" to the loop size.
       tot_zm_loops = tot_zm_loops + 1
    endif

    if ( any( vars_zm == "sclrp2" ) ) then
       ! Correct for number of variables found under "sclrp2".
       ! Subtract 1 from the loop size for each scalar.
       tot_zm_loops = tot_zm_loops - sclr_dim
       ! Add 1 for "sclrp2" to the loop size.
       tot_zm_loops = tot_zm_loops + 1
    endif

    if ( any( vars_zm == "sclrpthvp" ) ) then
       ! Correct for number of variables found under "sclrpthvp".
       ! Subtract 1 from the loop size for each scalar.
       tot_zm_loops = tot_zm_loops - sclr_dim
       ! Add 1 for "sclrpthvp" to the loop size.
       tot_zm_loops = tot_zm_loops + 1
    endif

    if ( any( vars_zm == "sclrpthlp" ) ) then
       ! Correct for number of variables found under "sclrpthlp".
       ! Subtract 1 from the loop size for each scalar.
       tot_zm_loops = tot_zm_loops - sclr_dim
       ! Add 1 for "sclrpthlp" to the loop size.
       tot_zm_loops = tot_zm_loops + 1
    endif

    if ( any( vars_zm == "sclrprcp" ) ) then
       ! Correct for number of variables found under "sclrprcp".
       ! Subtract 1 from the loop size for each scalar.
       tot_zm_loops = tot_zm_loops - sclr_dim
       ! Add 1 for "sclrprcp" to the loop size.
       tot_zm_loops = tot_zm_loops + 1
    endif

    if ( any( vars_zm == "wpsclrp" ) ) then
       ! Correct for number of variables found under "wpsclrp".
       ! Subtract 1 from the loop size for each scalar.
       tot_zm_loops = tot_zm_loops - sclr_dim
       ! Add 1 for "wpsclrp" to the loop size.
       tot_zm_loops = tot_zm_loops + 1
    endif

    if ( any( vars_zm == "wpsclrp2" ) ) then
       ! Correct for number of variables found under "wpsclrp2".
       ! Subtract 1 from the loop size for each scalar.
       tot_zm_loops = tot_zm_loops - sclr_dim
       ! Add 1 for "wpsclrp2" to the loop size.
       tot_zm_loops = tot_zm_loops + 1
    endif

    if ( any( vars_zm == "wp2sclrp" ) ) then
       ! Correct for number of variables found under "wp2sclrp".
       ! Subtract 1 from the loop size for each scalar.
       tot_zm_loops = tot_zm_loops - sclr_dim
       ! Add 1 for "wp2sclrp" to the loop size.
       tot_zm_loops = tot_zm_loops + 1
    endif

    if ( any( vars_zm == "wpsclrprtp" ) ) then
       ! Correct for number of variables found under "wpsclrprtp".
       ! Subtract 1 from the loop size for each scalar.
       tot_zm_loops = tot_zm_loops - sclr_dim
       ! Add 1 for "wpsclrprtp" to the loop size.
       tot_zm_loops = tot_zm_loops + 1
    endif

    if ( any( vars_zm == "wpsclrpthlp" ) ) then
       ! Correct for number of variables found under "wpsclrpthlp".
       ! Subtract 1 from the loop size for each scalar.
       tot_zm_loops = tot_zm_loops - sclr_dim
       ! Add 1 for "wpsclrpthlp" to the loop size.
       tot_zm_loops = tot_zm_loops + 1
    endif

    if ( any( vars_zm == "wpedsclrp" ) ) then
       ! Correct for number of variables found under "wpedsclrp".
       ! Subtract 1 from the loop size for each scalar.
       tot_zm_loops = tot_zm_loops - edsclr_dim
       ! Add 1 for "wpedsclrp" to the loop size.
       tot_zm_loops = tot_zm_loops + 1
  endif



    k = 1

    do i = 1, tot_zm_loops

      select case ( trim( vars_zm(i) ) )

      case ('wp2')
        stats_metadata%iwp2 = k
        call stat_assign( var_index=stats_metadata%iwp2, var_name="wp2", &
             var_description="w'^2, Variance of vertical air velocity", &
             var_units="m^2/s^2", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('rtp2')
        stats_metadata%irtp2 = k
        call stat_assign( var_index=stats_metadata%irtp2, var_name="rtp2", &
             var_description="rt'^2, Variance of total water, rt", var_units="(kg/kg)^2", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('thlp2')
        stats_metadata%ithlp2 = k
        call stat_assign( var_index=stats_metadata%ithlp2, var_name="thlp2", &
             var_description="thl'^2, Variance of theta_l", var_units="K^2", l_silhs=.false., &
             grid_kind=stats_zm )
        k = k + 1

      case ('rtpthlp')
        stats_metadata%irtpthlp = k
        call stat_assign( var_index=stats_metadata%irtpthlp, var_name="rtpthlp", &
             var_description="rt'thl', Covariance of rt and theta_l", &
             var_units="(kg K)/kg", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wprtp')
        stats_metadata%iwprtp = k

        call stat_assign( var_index=stats_metadata%iwprtp, var_name="wprtp", &
             var_description="w'rt', Vertical turbulent flux of total water, rt", &
             var_units="(m kg)/(s kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wpthlp')
        stats_metadata%iwpthlp = k

        call stat_assign( var_index=stats_metadata%iwpthlp, var_name="wpthlp", &
             var_description="w'thl', Vertical turbulent flux of theta_l", &
             var_units="(m K)/s", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wp3_zm')
        stats_metadata%iwp3_zm = k
        call stat_assign( var_index=stats_metadata%iwp3_zm, var_name="wp3_zm", &
             var_description="w'^3_zm, w'^3 interpolated to moment. levels", &
             var_units="(m^3)/(s^3)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('thlp3_zm')
        stats_metadata%ithlp3_zm = k
        call stat_assign( var_index=stats_metadata%ithlp3_zm, var_name="thlp3_zm", &
             var_description="thl'^3 interpolated to moment. levels", &
             var_units="K^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('rtp3_zm')
        stats_metadata%irtp3_zm = k
        call stat_assign( var_index=stats_metadata%irtp3_zm, var_name="rtp3_zm", &
             var_description="rt'^3 interpolated to moment. levels", &
             var_units="(kg^3)/(kg^3)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wp2up2')
        stats_metadata%iwp2up2 = k
        call stat_assign( var_index=stats_metadata%iwp2up2, var_name="wp2up2", &
             var_description="w'^2u'^2, 4th-order moment of vertical and zonal air velocity", &
             var_units="(m^4)/(s^4)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wp2vp2')
        stats_metadata%iwp2vp2 = k
        call stat_assign( var_index=stats_metadata%iwp2vp2, var_name="wp2vp2", &
             var_description &
               ="w'^2v'^2, 4th-order moment of vert. and merid. air velocity", &
             var_units="(m^4)/(s^4)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wp4')
        stats_metadata%iwp4 = k
        call stat_assign( var_index=stats_metadata%iwp4, var_name="wp4", &
             var_description="w'^4, Fourth-order moment of vertical air velocity", &
             var_units="(m^4)/(s^4)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wpthvp')
        stats_metadata%iwpthvp = k
        call stat_assign( var_index=stats_metadata%iwpthvp, var_name="wpthvp", &
             var_description="w'thv', Buoyancy flux", var_units="K m/s", l_silhs=.false., &
             grid_kind=stats_zm )
        k = k + 1

      case ('rtpthvp')
        stats_metadata%irtpthvp = k
        call stat_assign( var_index=stats_metadata%irtpthvp, var_name="rtpthvp", &
             var_description="rt'thv', Covariance of rt and theta_v", var_units="(kg/kg) K", &
             l_silhs=.false., &
             grid_kind=stats_zm )
        k = k + 1

      case ('thlpthvp')
        stats_metadata%ithlpthvp = k
        call stat_assign( var_index=stats_metadata%ithlpthvp, var_name="thlpthvp", &
          var_description="thl'thv', Covariance of theta_l and theta_v", var_units="K^2", &
          l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('tau_zm')
        stats_metadata%itau_zm = k

        call stat_assign( var_index=stats_metadata%itau_zm, var_name="tau_zm", &
             var_description="tau_zm, Time-scale tau on momentum levels", var_units="s", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('invrs_tau_zm')
        stats_metadata%iinvrs_tau_zm = k

        call stat_assign( var_index=stats_metadata%iinvrs_tau_zm, var_name="invrs_tau_zm", &
             var_description="invrs tau on momentum levels [s-1]", &
             var_units="s^-1", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('invrs_tau_xp2_zm')
        stats_metadata%iinvrs_tau_xp2_zm = k

        call stat_assign( var_index=stats_metadata%iinvrs_tau_xp2_zm, var_name="invrs_tau_xp2_zm", &
             var_description="invrs tau xp2 on momentum levels [s-1]", &
             var_units="s^-1", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('invrs_tau_wp2_zm')
        stats_metadata%iinvrs_tau_wp2_zm = k

        call stat_assign( var_index=stats_metadata%iinvrs_tau_wp2_zm, var_name="invrs_tau_wp2_zm", &
             var_description="invrs tau wp2 on momentum levels [s-1]", &
             var_units="s^-1", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('invrs_tau_wpxp_zm')
        stats_metadata%iinvrs_tau_wpxp_zm = k

        call stat_assign( var_index=stats_metadata%iinvrs_tau_wpxp_zm, var_name="invrs_tau_wpxp_zm", &
             var_description="invrs tau wpxp on momentum levels [s-1]", &
             var_units="s^-1", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('invrs_tau_wp3_zm')
        stats_metadata%iinvrs_tau_wp3_zm = k

        call stat_assign( var_index=stats_metadata%iinvrs_tau_wp3_zm, var_name="invrs_tau_wp3_zm", &
             var_description="invrs tau wp3 on momentum levels [s-1]", &
             var_units="s^-1", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('invrs_tau_no_N2_zm')
        stats_metadata%iinvrs_tau_no_N2_zm = k

        call stat_assign( var_index=stats_metadata%iinvrs_tau_no_N2_zm, var_name="invrs_tau_no_N2_zm", &
             var_description="invrs tau_no_N2 on momentum levels [s-1]", &
             var_units="s^-1", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('invrs_tau_bkgnd')
        stats_metadata%iinvrs_tau_bkgnd = k

        call stat_assign( var_index=stats_metadata%iinvrs_tau_bkgnd, var_name="invrs_tau_bkgnd", &
             var_description="invrs tau of bkgnd on momentum levels [s-1]", &
             var_units="s^-1", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('invrs_tau_sfc')
        stats_metadata%iinvrs_tau_sfc = k

        call stat_assign( var_index=stats_metadata%iinvrs_tau_sfc, var_name="invrs_tau_sfc", &
             var_description="invrs tau of surface on momentum levels [s-1]", &
             var_units="s^-1", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('invrs_tau_shear')
        stats_metadata%iinvrs_tau_shear = k

        call stat_assign( var_index=stats_metadata%iinvrs_tau_shear, var_name="invrs_tau_shear", &
             var_description="invrs tau of shear on momentum levels [s-1]", &
             var_units="s^-1", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('Kh_zm')
        stats_metadata%iKh_zm = k

        call stat_assign( var_index=stats_metadata%iKh_zm, var_name="Kh_zm", &
             var_description="Kh_zm, Eddy diffusivity on momentum levels", &
             var_units="m^2/s", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('K_hm')

         do hm_idx = 1, hydromet_dim, 1

            hm_type = hydromet_list(hm_idx)

            stats_metadata%iK_hm(hm_idx) = k


            call stat_assign( var_index=stats_metadata%iK_hm(hm_idx), &
                                 var_name="K_hm_"//trim( hm_type(1:2) ), &
                                 var_description="Eddy. diff. coef. of "  &
                                 // trim(hm_type(1:2)) &
                                 // " [m^2/s]", &
                                 var_units="[m^2/s]", &
                                 l_silhs=.false., grid_kind=stats_zm )

            k = k + 1

          end do


      case ('wprcp')
        stats_metadata%iwprcp = k
        call stat_assign( var_index=stats_metadata%iwprcp, var_name="wprcp", &
             var_description="w'rc'", var_units="(m/s) (kg/kg)", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('rc_coef_zm')
        stats_metadata%irc_coef_zm = k
        call stat_assign( var_index=stats_metadata%irc_coef_zm, var_name="rc_coef_zm", &
             var_description="rc_coef_zm, Coefficient of X'r_c'", &
             var_units="K/(kg/kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('thlprcp')
        stats_metadata%ithlprcp = k
        call stat_assign( var_index=stats_metadata%ithlprcp, var_name="thlprcp", &
             var_description="thl'rc'", var_units="K (kg/kg)", l_silhs=.false., &
             grid_kind=stats_zm )
        k = k + 1

      case ('rtprcp')
        stats_metadata%irtprcp = k

        call stat_assign( var_index=stats_metadata%irtprcp, var_name="rtprcp", &
             var_description="rt'rc'", var_units="(kg^2)/(kg^2)", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('rcp2')
        stats_metadata%ircp2 = k
        call stat_assign( var_index=stats_metadata%ircp2, var_name="rcp2", &
             var_description="rc'^2, Variance of cloud water mixing ratio", &
             var_units="(kg^2)/(kg^2)", l_silhs=.false., &
             grid_kind=stats_zm )
        k = k + 1
      case ('upwp')
        stats_metadata%iupwp = k
        call stat_assign( var_index=stats_metadata%iupwp, var_name="upwp", &
             var_description="u'w', Vertical turbulent flux of eastward (u) wind", &
             var_units="m^2/s^2", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('vpwp')
        stats_metadata%ivpwp = k
        call stat_assign( var_index=stats_metadata%ivpwp, var_name="vpwp", &
             var_description="v'w', Vertical turbulent flux of northward (v) wind", &
             var_units="m^2/s^2", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('upthlp')
        stats_metadata%iupthlp = k
        call stat_assign( var_index=stats_metadata%iupthlp, var_name="upthlp", &
             var_description="u'thl', Eastward theta_l flux", &
             var_units="(m/s)K", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('uprtp')
        stats_metadata%iuprtp = k
        call stat_assign( var_index=stats_metadata%iuprtp, var_name="uprtp", &
             var_description="u'rt', Eastward total water flux", &
             var_units="(m/s)(kg/kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('vpthlp')
        stats_metadata%ivpthlp = k
        call stat_assign( var_index=stats_metadata%ivpthlp, var_name="vpthlp", &
             var_description="v'thl', Northward theta_l flux", &
             var_units="(m/s)K", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('vprtp')
        stats_metadata%ivprtp = k
        call stat_assign( var_index=stats_metadata%ivprtp, var_name="vprtp", &
             var_description="v'rt', Northward total water flux", &
             var_units="(m/s)(kg/kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('upthvp')
        stats_metadata%iupthvp = k
        call stat_assign( var_index=stats_metadata%iupthvp, var_name="upthvp", &
             var_description="u'thv', Eastward theta_v flux", &
             var_units="(m/s)K", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('uprcp')
        stats_metadata%iuprcp = k
        call stat_assign( var_index=stats_metadata%iuprcp, var_name="uprcp", &
             var_description="u'rc', Eastward liquid water flux", &
             var_units="(m/s)(kg/kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('vpthvp')
        stats_metadata%ivpthvp = k
        call stat_assign( var_index=stats_metadata%ivpthvp, var_name="vpthvp", &
             var_description="v'thv', Northward theta_v flux", &
             var_units="(m/s)K", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('vprcp')
        stats_metadata%ivprcp = k
        call stat_assign( var_index=stats_metadata%ivprcp, var_name="vprcp", &
             var_description="v'rc', Northward liquid water flux", &
             var_units="(m/s)(kg/kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('rho_zm')
        stats_metadata%irho_zm = k
        call stat_assign( var_index=stats_metadata%irho_zm, var_name="rho_zm", &
             var_description="rho_zm, Density on momentum levels", var_units="kg m^{-3}", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('sigma_sqd_w')
        stats_metadata%isigma_sqd_w = k
        call stat_assign( var_index=stats_metadata%isigma_sqd_w, var_name="sigma_sqd_w", &
             var_description="sigma_sqd_w, Nondim w variance of Gaussian component", &
             var_units="-", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('rho_ds_zm')
        stats_metadata%irho_ds_zm = k
        call stat_assign( var_index=stats_metadata%irho_ds_zm, var_name="rho_ds_zm", &
             var_description="rho_ds_zm, Dry static, base-state density", var_units="kg m^{-3}", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('thv_ds_zm')
        stats_metadata%ithv_ds_zm = k
        call stat_assign( var_index=stats_metadata%ithv_ds_zm, var_name="thv_ds_zm", &
             var_description="thv_ds_zm, Dry, base-state theta_v", var_units="K", l_silhs=.false.,&
             grid_kind=stats_zm )
        k = k + 1
      case ('em')
        stats_metadata%iem = k
        call stat_assign( var_index=stats_metadata%iem, var_name="em", &
             var_description="em, Turbulent kinetic energy, usu. 0.5*(u'^2+v'^2+w'^2)", &
             var_units="m^2/s^2", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('shear')      ! Brian
        stats_metadata%ishear = k
        call stat_assign( var_index=stats_metadata%ishear, var_name="shear", &
             var_description="shear, Wind shear production term", var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('mean_w_up')
        stats_metadata%imean_w_up = k
        call stat_assign( var_index=stats_metadata%imean_w_up, var_name="mean_w_up", &
             var_description="mean_w_up, Mean w >= w_ref", var_units="m/s", l_silhs=.false., &
             grid_kind=stats_zm )
        k = k + 1
      case ('mean_w_down')
        stats_metadata%imean_w_down = k
        call stat_assign( var_index=stats_metadata%imean_w_down, var_name="mean_w_down", &
             var_description="mean_w_down, Mean w <= w_ref", var_units="m/s", l_silhs=.false., &
             grid_kind=stats_zm )
        k = k + 1
      case ('Frad')
        stats_metadata%iFrad = k
        call stat_assign( var_index=stats_metadata%iFrad, var_name="Frad", &
             var_description="Frad, Total (sw+lw) net (up+down) radiative flux", &
             var_units="W/m^2", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('Frad_LW')    ! Brian
        stats_metadata%iFrad_LW = k
        call stat_assign( var_index=stats_metadata%iFrad_LW, var_name="Frad_LW", &
             var_description="Frad_LW, Net long-wave radiative flux", var_units="W/m^2", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('Frad_SW')    ! Brian
        stats_metadata%iFrad_SW = k

        call stat_assign( var_index=stats_metadata%iFrad_SW, var_name="Frad_SW", &
             var_description="Frad_SW, Net short-wave radiative flux", var_units="W/m^2", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('Frad_LW_up')    ! Brian
        stats_metadata%iFrad_LW_up = k
        call stat_assign( var_index=stats_metadata%iFrad_LW_up, var_name="Frad_LW_up", &
             var_description="Frad_LW_up, Long-wave upwelling radiative flux", &
             var_units="W/m^2", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('Frad_SW_up')    ! Brian
        stats_metadata%iFrad_SW_up = k

        call stat_assign( var_index=stats_metadata%iFrad_SW_up, var_name="Frad_SW_up", &
             var_description="Frad_SW_up, Short-wave upwelling radiative flux", &
             var_units="W/m^2", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('Frad_LW_down')    ! Brian
        stats_metadata%iFrad_LW_down = k
        call stat_assign( var_index=stats_metadata%iFrad_LW_down, var_name="Frad_LW_down", &
             var_description="Frad_LW_down, Long-wave downwelling radiative flux", &
             var_units="W/m^2", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('Frad_SW_down')    ! Brian
        stats_metadata%iFrad_SW_down = k

        call stat_assign( var_index=stats_metadata%iFrad_SW_down, var_name="Frad_SW_down", &
             var_description="Frad_SW_down, Short-wave downwelling radiative flux", &
             var_units="W/m^2", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1


      case ('Fprec')      ! Brian
        stats_metadata%iFprec = k

        call stat_assign( var_index=stats_metadata%iFprec, var_name="Fprec", &
             var_description="Fprec, Rain flux", var_units="W/m^2", l_silhs=.false., &
             grid_kind=stats_zm )
        k = k + 1

      case ('Fcsed')      ! Brian
        stats_metadata%iFcsed = k

        call stat_assign( var_index=stats_metadata%iFcsed, var_name="Fcsed", &
             var_description="Fcsed, cloud water sedimentation flux", &
             var_units="kg/(s*m^2)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case('hydrometp2')

         do hm_idx = 1, hydromet_dim, 1

            hm_type = hydromet_list(hm_idx)

            ! The overall variance of the hydrometeor.
            stats_metadata%ihydrometp2(hm_idx) = k

            if ( l_mix_rat_hm(hm_idx) ) then

               call stat_assign( var_index=stats_metadata%ihydrometp2(hm_idx), &
                                 var_name=trim( hm_type(1:2) )//"p2", &
                                 var_description="<" &
                                 // hm_type(1:1)//"_"//trim( hm_type(2:2) ) &
                                 // "'^2> [(kg/kg)^2]", &
                                 var_units="(kg/kg)^2", &
                                 l_silhs=.false., grid_kind=stats_zm )

            else ! Concentration

               call stat_assign( var_index=stats_metadata%ihydrometp2(hm_idx), &
                                 var_name=trim( hm_type(1:2) )//"p2", &
                                 var_description="<" &
                                 // hm_type(1:1)//"_"//trim( hm_type(2:2) ) &
                                 // "'^2> [(num/kg)^2]", &
                                 var_units="(num/kg)^2", &
                                 l_silhs=.false., grid_kind=stats_zm )

            endif ! l_mix_rat_hm(hm_idx)

            k = k + 1

         enddo ! hm_idx = 1, hydromet_dim, 1

      case ('wphydrometp')

         do hm_idx = 1, hydromet_dim, 1

            hm_type = hydromet_list(hm_idx)

            stats_metadata%iwphydrometp(hm_idx) = k

            if ( l_mix_rat_hm(hm_idx) ) then

               call stat_assign( var_index=stats_metadata%iwphydrometp(hm_idx), &
                                 var_name="wp"//trim( hm_type(1:2) )//"p", &
                                 var_description="Covariance of w and " &
                                 // hm_type(1:1)//"_"//trim( hm_type(2:2) ) &
                                 // " [(m/s) kg/kg]", &
                                 var_units="(m/s) kg/kg", &
                                 l_silhs=.false., grid_kind=stats_zm )

            else ! Concentration

               call stat_assign( var_index=stats_metadata%iwphydrometp(hm_idx), &
                                 var_name="wp"//trim( hm_type(1:2) )//"p", &
                                 var_description="Covariance of w and " &
                                 // hm_type(1:1)//"_"//trim( hm_type(2:2) ) &
                                 // " [(m/s) num/kg]", &
                                 var_units="(m/s) num/kg", &
                                 l_silhs=.false., grid_kind=stats_zm )

            endif ! l_mix_rat_hm(hm_idx)

            k = k + 1

         enddo ! hm_idx = 1, hydromet_dim, 1

      case ('wpNcp')
        stats_metadata%iwpNcp = k

        call stat_assign( var_index=stats_metadata%iwpNcp, var_name="wpNcp", &
                          var_description="w'Nc', Covariance of w and " &
                                          // "N_c", &
                          var_units="(m/s) num/kg", &
                          l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('rtphmp')

         do hm_idx = 1, hydromet_dim, 1

            hm_type = hydromet_list(hm_idx)

            stats_metadata%irtphmp(hm_idx) = k

            if ( l_mix_rat_hm(hm_idx) ) then

               call stat_assign( var_index=stats_metadata%irtphmp(hm_idx), &
                                 var_name="rtp"//trim( hm_type(1:2) )//"p", &
                                 var_description="Covariance of r_t and " &
                                 // hm_type(1:1)//"_"//trim( hm_type(2:2) ) &
                                 // " [kg^2/kg^2]", &
                                 var_units="kg^2/kg^2", &
                                 l_silhs=.false., grid_kind=stats_zm )

            else ! Concentration

               call stat_assign( var_index=stats_metadata%irtphmp(hm_idx), &
                                 var_name="rtp"//trim( hm_type(1:2) )//"p", &
                                 var_description="Covariance of r_t and " &
                                 // hm_type(1:1)//"_"//trim( hm_type(2:2) ) &
                                 // " [(kg/kg) num/kg]", &
                                 var_units="(kg/kg) num/kg", &
                                 l_silhs=.false., grid_kind=stats_zm )

            endif ! l_mix_rat_hm(hm_idx)

            k = k + 1

         enddo ! hm_idx = 1, hydromet_dim, 1

      case ('thlphmp')

         do hm_idx = 1, hydromet_dim, 1

            hm_type = hydromet_list(hm_idx)

            stats_metadata%ithlphmp(hm_idx) = k

            if ( l_mix_rat_hm(hm_idx) ) then

               call stat_assign( var_index=stats_metadata%ithlphmp(hm_idx), &
                                 var_name="thlp"//trim( hm_type(1:2) )//"p", &
                                 var_description="Covariance of th_l and " &
                                 // hm_type(1:1)//"_"//trim( hm_type(2:2) ) &
                                 // " [K kg/kg]", &
                                 var_units="K kg/kg", &
                                 l_silhs=.false., grid_kind=stats_zm )

            else ! Concentration

               call stat_assign( var_index=stats_metadata%ithlphmp(hm_idx), &
                                 var_name="thlp"//trim( hm_type(1:2) )//"p", &
                                 var_description="Covariance of th_l and " &
                                 // hm_type(1:1)//"_"//trim( hm_type(2:2) ) &
                                 // " [K num/kg]", &
                                 var_units="K num/kg", &
                                 l_silhs=.false., grid_kind=stats_zm )

            endif ! l_mix_rat_hm(hm_idx)

            k = k + 1

         enddo ! hm_idx = 1, hydromet_dim, 1

      case ('hmxphmyp')

         do hmx_idx = 1, hydromet_dim, 1

            hmx_type = hydromet_list(hmx_idx)

            do hmy_idx = hmx_idx+1, hydromet_dim, 1

               hmy_type = hydromet_list(hmy_idx)

               ! The covariance (overall) of hmx and hmy.
               stats_metadata%ihmxphmyp(hmy_idx,hmx_idx) = k

               if ( l_mix_rat_hm(hmx_idx) .and. l_mix_rat_hm(hmy_idx) ) then

                  ! Both hydrometeors are mixing ratios.
                  call stat_assign( var_index=stats_metadata%ihmxphmyp(hmy_idx,hmx_idx), &
                                    var_name=trim( hmx_type(1:2) )//"p" &
                                    // trim( hmy_type(1:2) )//"p", &
                                    var_description="Covariance of " &
                                    // hmx_type(1:1)//"_"//trim(hmx_type(2:2)) &
                                    // " and " &
                                    // hmy_type(1:1)//"_"//trim(hmy_type(2:2)) &
                                    // " [(kg/kg)^2]", &
                                    var_units="(kg/kg)^2", l_silhs=.false., &
                                    grid_kind=stats_zm )

               elseif ( ( .not. l_mix_rat_hm(hmx_idx) ) &
                        .and. ( .not. l_mix_rat_hm(hmy_idx) ) ) then

                  ! Both hydrometeors are concentrations.
                  call stat_assign( var_index=stats_metadata%ihmxphmyp(hmy_idx,hmx_idx), &
                                    var_name=trim( hmx_type(1:2) )//"p" &
                                    // trim( hmy_type(1:2) )//"p", &
                                    var_description="Covariance of " &
                                    // hmx_type(1:1)//"_"//trim(hmx_type(2:2)) &
                                    // " and " &
                                    // hmy_type(1:1)//"_"//trim(hmy_type(2:2)) &
                                    // " [(num/kg)^2]", &
                                    var_units="(num/kg)^2", l_silhs=.false., &
                                    grid_kind=stats_zm )

               else

                  ! One hydrometeor is a mixing ratio and the other hydrometeor
                  ! is a concentration.
                  call stat_assign( var_index=stats_metadata%ihmxphmyp(hmy_idx,hmx_idx), &
                                    var_name=trim( hmx_type(1:2) )//"p" &
                                    // trim( hmy_type(1:2) )//"p", &
                                    var_description="Covariance of " &
                                    // hmx_type(1:1)//"_"//trim(hmx_type(2:2)) &
                                    // " and " &
                                    // hmy_type(1:1)//"_"//trim(hmy_type(2:2)) &
                                    // " [(kg/kg) num/kg]", &
                                    var_units="(kg/kg) num/kg", &
                                    l_silhs=.false., grid_kind=stats_zm )

               endif

               k = k + 1

            enddo ! hmy_idx = hmx_idx+1, hydromet_dim, 1

         enddo ! hmx_idx = 1, hydromet_dim, 1

      case ('VNr')
        stats_metadata%iVNr = k

        call stat_assign( var_index=stats_metadata%iVNr, var_name="VNr", &
             var_description="VNr, rrm concentration fallspeed", var_units="m/s", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('Vrr')
        stats_metadata%iVrr = k

        call stat_assign( var_index=stats_metadata%iVrr, var_name="Vrr", &
             var_description="Vrr, rrm mixing ratio fallspeed", var_units="m/s", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('VNc')
        stats_metadata%iVNc = k

        call stat_assign( var_index=stats_metadata%iVNc, var_name="VNc", &
             var_description="VNc, Nrm concentration fallspeed", var_units="m/s", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('Vrc')
        stats_metadata%iVrc = k

        call stat_assign( var_index=stats_metadata%iVrc, var_name="Vrc", &
             var_description="Vrc, Nrm mixing ratio fallspeed", var_units="m/s", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('VNs')
        stats_metadata%iVNs = k

        call stat_assign( var_index=stats_metadata%iVNs, var_name="VNs", &
             var_description="VNs, Snow concentration fallspeed", var_units="m/s", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('Vrs')
        stats_metadata%iVrs = k

        call stat_assign( var_index=stats_metadata%iVrs, var_name="Vrs", &
             var_description="Vrs, Snow mixing ratio fallspeed", var_units="m/s", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('Vrg')
        stats_metadata%iVrg = k

        call stat_assign( var_index=stats_metadata%iVrg, var_name="Vrg", &
             var_description="Vrg, Graupel sedimentation velocity", var_units="m/s", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('VNi')
        stats_metadata%iVNi = k

        call stat_assign( var_index=stats_metadata%iVNi, var_name="VNi", &
             var_description="VNi, Cloud ice concentration fallspeed", var_units="m/s", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('Vri')
        stats_metadata%iVri = k

        call stat_assign( var_index=stats_metadata%iVri, var_name="Vri", &
             var_description="Vri, Cloud ice mixing ratio fallspeed", var_units="m/s", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('Vrrprrp')
        stats_metadata%iVrrprrp = k

        call stat_assign( var_index=stats_metadata%iVrrprrp, var_name="Vrrprrp", &
             var_description="Vrr'rr', Covariance of V_rr (r_r sed. vel.) and r_r", &
             var_units="(m/s)(kg/kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('VNrpNrp')
        stats_metadata%iVNrpNrp = k

        call stat_assign( var_index=stats_metadata%iVNrpNrp, var_name="VNrpNrp", &
             var_description="VNr'Nr', Covariance of V_Nr (N_r sed. vel.) and N_r", &
             var_units="(m/s)(num/kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('Vrrprrp_expcalc')
        stats_metadata%iVrrprrp_expcalc = k

        call stat_assign( var_index=stats_metadata%iVrrprrp_expcalc, var_name="Vrrprrp_expcalc", &
             var_description="Vrr'rr'_expcalc, completely explicit calculation", &
             var_units="(m/s)(kg/kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('VNrpNrp_expcalc')
        stats_metadata%iVNrpNrp_expcalc = k

        call stat_assign( var_index=stats_metadata%iVNrpNrp_expcalc, var_name="VNrpNrp_expcalc", &
             var_description="VNr'Nr'_expcalc, V_Nr'N_r' completely explicit calculation", &
             var_units="(m/s)(num/kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wp2_bt')
        stats_metadata%iwp2_bt = k

        call stat_assign( var_index=stats_metadata%iwp2_bt, var_name="wp2_bt", &
             var_description="w'^2_bt, wp2 budget: wp2 time tendency", var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wp2_ma')
        stats_metadata%iwp2_ma = k

        call stat_assign( var_index=stats_metadata%iwp2_ma, var_name="wp2_ma", &
             var_description="w'^2_ma, wp2 budget: wp2 vertical mean advection", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wp2_ta')
        stats_metadata%iwp2_ta = k

        call stat_assign( var_index=stats_metadata%iwp2_ta, var_name="wp2_ta", &
             var_description="w'^2_ta, wp2 budget: wp2 turbulent advection", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wp2_ac')
        stats_metadata%iwp2_ac = k

        call stat_assign( var_index=stats_metadata%iwp2_ac, var_name="wp2_ac", &
             var_description="w'^2_ac, wp2 budget: wp2 accumulation term", var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wp2_bp')
        stats_metadata%iwp2_bp = k

        call stat_assign( var_index=stats_metadata%iwp2_bp, var_name="wp2_bp", &
             var_description="w'^2_bp, wp2 budget: wp2 buoyancy production", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wp2_pr1')
        stats_metadata%iwp2_pr1 = k

        call stat_assign( var_index=stats_metadata%iwp2_pr1, var_name="wp2_pr1", &
             var_description="w'^2_pr1, wp2 budget: wp2 pressure term 1", var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wp2_pr2')
        stats_metadata%iwp2_pr2 = k
        call stat_assign( var_index=stats_metadata%iwp2_pr2, var_name="wp2_pr2", &
             var_description="w'^2_pr2, wp2 budget: wp2 pressure term 2", var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wp2_pr3')
        stats_metadata%iwp2_pr3 = k
        call stat_assign( var_index=stats_metadata%iwp2_pr3, var_name="wp2_pr3", &
             var_description="w'^2_pr3, wp2 budget: wp2 pressure term 3", var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )

        k = k + 1

      case ('wp2_pr_dfsn')
        stats_metadata%iwp2_pr_dfsn = k
        call stat_assign( var_index=stats_metadata%iwp2_pr_dfsn, var_name="wp2_pr_dfsn", &
             var_description="w'^2_pr_dfsn, wp2 budget: wp2 pressure diffusion term", &
              var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )

        k = k + 1

      case ('wp2_dp1')
        stats_metadata%iwp2_dp1 = k
        call stat_assign( var_index=stats_metadata%iwp2_dp1, var_name="wp2_dp1", &
             var_description="w'^2_dp1, wp2 budget: wp2 dissipation term 1", &
             var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wp2_dp2')
        stats_metadata%iwp2_dp2 = k
        call stat_assign( var_index=stats_metadata%iwp2_dp2, var_name="wp2_dp2", &
             var_description="w'^2_d'^2, wp2 budget: wp2 dissipation term 2", &
             var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )

        k = k + 1

      case ('wp2_sdmp')
        stats_metadata%iwp2_sdmp = k
        call stat_assign( var_index=stats_metadata%iwp2_sdmp, var_name="wp2_sdmp", &
             var_description="w'^2_sdmp, wp2 budget: wp2 sponge damping term", &
             var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wp2_cl')
        stats_metadata%iwp2_cl = k

        call stat_assign( var_index=stats_metadata%iwp2_cl, var_name="wp2_cl", &
             var_description="w'^2_cl, wp2 budget: wp2 clipping term", var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )

        k = k + 1

      case ('wp2_pd')
        stats_metadata%iwp2_pd = k

        call stat_assign( var_index=stats_metadata%iwp2_pd, var_name="wp2_pd", &
             var_description="w'^2_pd, wp2 budget: wp2 positive definite adjustment", &
             var_units="m2/s3", l_silhs=.false., grid_kind=stats_zm )

        k = k + 1

      case ('wp2_sf')
        stats_metadata%iwp2_sf = k

        call stat_assign( var_index=stats_metadata%iwp2_sf, var_name="wp2_sf", &
             var_description="w'^2_sf, wp2 budget: wp2 surface variance", var_units="m2/s3", &
             l_silhs=.false., grid_kind=stats_zm )

        k = k + 1

      case ('wp2_splat')
        stats_metadata%iwp2_splat = k

        call stat_assign( var_index=stats_metadata%iwp2_splat, var_name="wp2_splat", &
             var_description="w'^2_splat, wp2 budget: wp2 splatting", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )

        k = k + 1

      case ('wprtp_bt')
        stats_metadata%iwprtp_bt = k
        call stat_assign( var_index=stats_metadata%iwprtp_bt, var_name="wprtp_bt", &
             var_description="w'rt'_bt, wprtp budget: wprtp time tendency", &
             var_units="(m kg)/(s^2 kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wprtp_ma')
        stats_metadata%iwprtp_ma = k

        call stat_assign( var_index=stats_metadata%iwprtp_ma, var_name="wprtp_ma", &
             var_description="w'rt'_ma, wprtp budget: wprtp mean advection", &
             var_units="(m kg)/(s^2 kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wprtp_ta')
        stats_metadata%iwprtp_ta = k

        call stat_assign( var_index=stats_metadata%iwprtp_ta, var_name="wprtp_ta", &
             var_description="w'rt'_ta, wprtp budget: wprtp turbulent advection", &
             var_units="(m kg)/(s^2 kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wprtp_tp')
        stats_metadata%iwprtp_tp = k

        call stat_assign( var_index=stats_metadata%iwprtp_tp, var_name="wprtp_tp", &
             var_description="w'rt'_t', wprtp budget: wprtp turbulent production", &
             var_units="(m kg)/(s^2 kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wprtp_ac')
        stats_metadata%iwprtp_ac = k

        call stat_assign( var_index=stats_metadata%iwprtp_ac, var_name="wprtp_ac", &
             var_description="w'rt'_ac, wprtp budget: wprtp accumulation term", &
             var_units="(m kg)/(s^2 kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wprtp_bp')
        stats_metadata%iwprtp_bp = k

        call stat_assign( var_index=stats_metadata%iwprtp_bp, var_name="wprtp_bp", &
             var_description="w'rt'_b', wprtp budget: wprtp buoyancy production", &
             var_units="(m kg)/(s^2 kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wprtp_pr1')
        stats_metadata%iwprtp_pr1 = k

        call stat_assign( var_index=stats_metadata%iwprtp_pr1, var_name="wprtp_pr1", &
             var_description="w'rt'_pr1, wprtp budget: wprtp pressure term 1", &
             var_units="(m kg)/(s^2 kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wprtp_pr2')
        stats_metadata%iwprtp_pr2 = k

        call stat_assign( var_index=stats_metadata%iwprtp_pr2, var_name="wprtp_pr2", &
             var_description="w'rt'_pr2, wprtp budget: wprtp pressure term 2", &
             var_units="(m kg)/(s^2 kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wprtp_pr3')
        stats_metadata%iwprtp_pr3 = k

        call stat_assign( var_index=stats_metadata%iwprtp_pr3, var_name="wprtp_pr3", &
             var_description="w'rt'_pr3, wprtp budget: wprtp pressure term 3", &
             var_units="(m kg)/(s^2 kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wprtp_dp1')
        stats_metadata%iwprtp_dp1 = k

        call stat_assign( var_index=stats_metadata%iwprtp_dp1, var_name="wprtp_dp1", &
             var_description="w'rt'_dp1, wprtp budget: wprtp dissipation term 1", &
             var_units="(m kg)/(s^2 kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wprtp_mfl')
        stats_metadata%iwprtp_mfl = k

        call stat_assign( var_index=stats_metadata%iwprtp_mfl, var_name="wprtp_mfl", &
             var_description="w'rt'_mfl, wprtp budget: wprtp monotonic flux limiter", &
             var_units="(m kg)/(s^2 kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wprtp_cl')
        stats_metadata%iwprtp_cl = k

        call stat_assign( var_index=stats_metadata%iwprtp_cl, var_name="wprtp_cl", &
             var_description="w'rt'_cl, wprtp budget: wprtp clipping term", &
             var_units="(m kg)/(s^2 kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wprtp_sicl')
        stats_metadata%iwprtp_sicl = k

        call stat_assign( var_index=stats_metadata%iwprtp_sicl, var_name="wprtp_sicl", &
             var_description="w'rt'_sicl, wprtp budget: wprtp semi-implicit clipping term", &
             var_units="(m kg)/(s^2 kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wprtp_pd')
        stats_metadata%iwprtp_pd = k

        call stat_assign( var_index=stats_metadata%iwprtp_pd, var_name="wprtp_pd", &
             var_description="w'rt'_pd, wprtp budget: wprtp flux corrected trans. term", &
             var_units="(m kg)/(s^2 kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wprtp_forcing')
        stats_metadata%iwprtp_forcing = k

        call stat_assign( var_index=stats_metadata%iwprtp_forcing, var_name="wprtp_forcing", &
             var_description="w'rt'_forcing, wprtp budget: wprtp forcing " &
             // "(includes microphysics tendency)", &
             var_units="(m kg/kg)/s^2", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wprtp_mc')
        stats_metadata%iwprtp_mc = k

        call stat_assign( var_index=stats_metadata%iwprtp_mc, var_name="wprtp_mc", &
             var_description="w'rt'_mc, Microphysics tendency for wprtp (not in budget)", &
             var_units="(m kg/kg)/s^2", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wpthlp_bt')
        stats_metadata%iwpthlp_bt = k

        call stat_assign( var_index=stats_metadata%iwpthlp_bt, var_name="wpthlp_bt", &
             var_description="w'thl'_bt, wpthlp budget", var_units="(m K)/s^2", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wpthlp_ma')
        stats_metadata%iwpthlp_ma = k
        call stat_assign( var_index=stats_metadata%iwpthlp_ma, var_name="wpthlp_ma", &
             var_description="w'thl'_ma, wpthlp budget: wpthlp mean advection", &
             var_units="(m K)/s^2", l_silhs=.false., grid_kind=stats_zm )

        k = k + 1

      case ('wpthlp_ta')
        stats_metadata%iwpthlp_ta = k
        call stat_assign( var_index=stats_metadata%iwpthlp_ta, var_name="wpthlp_ta", &
             var_description="w'thl'_ta, wpthlp budget: wpthlp turbulent advection", &
             var_units="(m K)/s^2", l_silhs=.false., grid_kind=stats_zm )

        k = k + 1

      case ('wpthlp_tp')
        stats_metadata%iwpthlp_tp = k
        call stat_assign( var_index=stats_metadata%iwpthlp_tp, var_name="wpthlp_tp", &
             var_description="w'thl'_tp, wpthlp budget: wpthlp turbulent production", &
             var_units="(m K)/s^2", l_silhs=.false., grid_kind=stats_zm )

        k = k + 1

      case ('wpthlp_ac')
        stats_metadata%iwpthlp_ac = k
        call stat_assign( var_index=stats_metadata%iwpthlp_ac, var_name="wpthlp_ac", &
             var_description="w'thl'_ac, wpthlp budget: wpthlp accumulation term", &
             var_units="(m K)/s^2", l_silhs=.false., grid_kind=stats_zm )

        k = k + 1

      case ('wpthlp_bp')
        stats_metadata%iwpthlp_bp = k
        call stat_assign( var_index=stats_metadata%iwpthlp_bp, var_name="wpthlp_bp", &
             var_description="w'thl'_b', wpthlp budget: wpthlp buoyancy production", &
             var_units="(m K)/s^2", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wpthlp_pr1')
        stats_metadata%iwpthlp_pr1 = k

        call stat_assign( var_index=stats_metadata%iwpthlp_pr1, var_name="wpthlp_pr1", &
             var_description="w'thl'_pr1, wpthlp budget: wpthlp pressure term 1", &
             var_units="(m K)/s^2", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wpthlp_pr2')
        stats_metadata%iwpthlp_pr2 = k

        call stat_assign( var_index=stats_metadata%iwpthlp_pr2, var_name="wpthlp_pr2", &
             var_description="w'thl'_pr2, wpthlp budget: wpthlp pressure term 2", &
             var_units="(m K)/s^2", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wpthlp_pr3')
        stats_metadata%iwpthlp_pr3 = k
        call stat_assign( var_index=stats_metadata%iwpthlp_pr3, var_name="wpthlp_pr3", &
             var_description="w'thl'_pr3, wpthlp budget: wpthlp pressure term 3", &
             var_units="(m K)/s^2", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wpthlp_dp1')
        stats_metadata%iwpthlp_dp1 = k
        call stat_assign( var_index=stats_metadata%iwpthlp_dp1, var_name="wpthlp_dp1", &
             var_description="w'thl'_dp1, wpthlp budget: wpthlp dissipation term 1", &
             var_units="(m K)/s^2", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wpthlp_mfl')
        stats_metadata%iwpthlp_mfl = k
        call stat_assign( var_index=stats_metadata%iwpthlp_mfl, var_name="wpthlp_mfl", &
             var_description="w'thl'_mfl, wpthlp budget: wpthlp monotonic flux limiter", &
             var_units="(m K)/s^2", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wpthlp_cl')
        stats_metadata%iwpthlp_cl = k
        call stat_assign( var_index=stats_metadata%iwpthlp_cl, var_name="wpthlp_cl", &
             var_description="w'thl'_cl, wpthlp budget: wpthlp clipping term", &
             var_units="(m K)/s^2", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wpthlp_sicl')
        stats_metadata%iwpthlp_sicl = k
        call stat_assign( var_index=stats_metadata%iwpthlp_sicl, var_name="wpthlp_sicl", &
             var_description="w'thl'_sicl, wpthlp budget: wpthlp semi-implicit clipping term", &
             var_units="(m K)/s^2", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wpthlp_forcing')
        stats_metadata%iwpthlp_forcing = k

        call stat_assign( var_index=stats_metadata%iwpthlp_forcing, var_name="wpthlp_forcing", &
             var_description="w'thl'_forcing, wpthlp budget: wpthlp forcing " &
             // "(includes microphysics tendency)", &
             var_units="(m K)/s^2", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wpthlp_mc')
        stats_metadata%iwpthlp_mc = k

        call stat_assign( var_index=stats_metadata%iwpthlp_mc, var_name="wpthlp_mc", &
             var_description="w'thl'_mc, Microphysics tendency for wpthlp (not in budget)", &
             var_units="(m K)/s^2", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('upwp_bt')
        stats_metadata%iupwp_bt = k
        call stat_assign( var_index=stats_metadata%iupwp_bt, var_name="upwp_bt", &
             var_description="u'w'_bt, upwp budget: upwp time tendency", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('upwp_ma')
        stats_metadata%iupwp_ma = k
        call stat_assign( var_index=stats_metadata%iupwp_ma, var_name="upwp_ma", &
             var_description="u'w'_ma, upwp budget: upwp mean advection", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('upwp_ta')
        stats_metadata%iupwp_ta = k
        call stat_assign( var_index=stats_metadata%iupwp_ta, var_name="upwp_ta", &
             var_description="u'w'_ta, upwp budget: upwp turbulent advection", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('upwp_tp')
        stats_metadata%iupwp_tp = k
        call stat_assign( var_index=stats_metadata%iupwp_tp, var_name="upwp_tp", &
             var_description="u'w'_t', upwp budget: upwp turbulent production", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('upwp_ac')
        stats_metadata%iupwp_ac = k
        call stat_assign( var_index=stats_metadata%iupwp_ac, var_name="upwp_ac", &
             var_description="u'w'_ac, upwp budget: upwp accumulation term", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('upwp_bp')
        stats_metadata%iupwp_bp = k
        call stat_assign( var_index=stats_metadata%iupwp_bp, var_name="upwp_bp", &
             var_description="u'w'_b', upwp budget: upwp buoyancy production", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('upwp_pr1')
        stats_metadata%iupwp_pr1 = k
        call stat_assign( var_index=stats_metadata%iupwp_pr1, var_name="upwp_pr1", &
             var_description="u'w'_pr1, upwp budget: upwp pressure term 1", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('upwp_pr2')
        stats_metadata%iupwp_pr2 = k
        call stat_assign( var_index=stats_metadata%iupwp_pr2, var_name="upwp_pr2", &
             var_description="u'w'_pr2, upwp budget: upwp pressure term 2", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('upwp_pr3')
        stats_metadata%iupwp_pr3 = k
        call stat_assign( var_index=stats_metadata%iupwp_pr3, var_name="upwp_pr3", &
             var_description="u'w'_pr3, upwp budget: upwp pressure term 3", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('upwp_pr4')
        stats_metadata%iupwp_pr4 = k
        call stat_assign( var_index=stats_metadata%iupwp_pr4, var_name="upwp_pr4", &
             var_description="u'w'_pr4, upwp budget: upwp pressure term 4", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('upwp_dp1')
        stats_metadata%iupwp_dp1 = k
        call stat_assign( var_index=stats_metadata%iupwp_dp1, var_name="upwp_dp1", &
             var_description="u'w'_dp1, upwp budget: upwp dissipation term 1", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('upwp_mfl')
        stats_metadata%iupwp_mfl = k
        call stat_assign( var_index=stats_metadata%iupwp_mfl, var_name="upwp_mfl", &
             var_description="u'w'_mfl, upwp budget: upwp monotonic flux limiter", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('upwp_cl')
        stats_metadata%iupwp_cl = k
        call stat_assign( var_index=stats_metadata%iupwp_cl, var_name="upwp_cl", &
             var_description="u'w'_cl, upwp budget: upwp clipping term", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vpwp_bt')
        stats_metadata%ivpwp_bt = k
        call stat_assign( var_index=stats_metadata%ivpwp_bt, var_name="vpwp_bt", &
             var_description="v'w'_bt, vpwp budget: vpwp time tendency", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vpwp_ma')
        stats_metadata%ivpwp_ma = k
        call stat_assign( var_index=stats_metadata%ivpwp_ma, var_name="vpwp_ma", &
             var_description="v'w'_ma, vpwp budget: vpwp mean advection", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vpwp_ta')
        stats_metadata%ivpwp_ta = k
        call stat_assign( var_index=stats_metadata%ivpwp_ta, var_name="vpwp_ta", &
             var_description="v'w'_ta, vpwp budget: vpwp turbulent advection", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vpwp_tp')
        stats_metadata%ivpwp_tp = k
        call stat_assign( var_index=stats_metadata%ivpwp_tp, var_name="vpwp_tp", &
             var_description="v'w'_t', vpwp budget: vpwp turbulent production", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vpwp_ac')
        stats_metadata%ivpwp_ac = k
        call stat_assign( var_index=stats_metadata%ivpwp_ac, var_name="vpwp_ac", &
             var_description="v'w'_ac, vpwp budget: vpwp accumulation term", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vpwp_bp')
        stats_metadata%ivpwp_bp = k
        call stat_assign( var_index=stats_metadata%ivpwp_bp, var_name="vpwp_bp", &
             var_description="v'w'_b', vpwp budget: vpwp buoyancy production", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vpwp_pr1')
        stats_metadata%ivpwp_pr1 = k
        call stat_assign( var_index=stats_metadata%ivpwp_pr1, var_name="vpwp_pr1", &
             var_description="v'w'_pr1, vpwp budget: vpwp pressure term 1", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vpwp_pr2')
        stats_metadata%ivpwp_pr2 = k
        call stat_assign( var_index=stats_metadata%ivpwp_pr2, var_name="vpwp_pr2", &
             var_description="v'w'_pr2, vpwp budget: vpwp pressure term 2", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vpwp_pr3')
        stats_metadata%ivpwp_pr3 = k
        call stat_assign( var_index=stats_metadata%ivpwp_pr3, var_name="vpwp_pr3", &
             var_description="v'w'_pr3, vpwp budget: vpwp pressure term 3", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vpwp_pr4')
        stats_metadata%ivpwp_pr4 = k
        call stat_assign( var_index=stats_metadata%ivpwp_pr4, var_name="vpwp_pr4", &
             var_description="v'w'_pr4, vpwp budget: vpwp pressure term 4", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vpwp_dp1')
        stats_metadata%ivpwp_dp1 = k
        call stat_assign( var_index=stats_metadata%ivpwp_dp1, var_name="vpwp_dp1", &
             var_description="v'w'_dp1, vpwp budget: vpwp dissipation term 1", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vpwp_mfl')
        stats_metadata%ivpwp_mfl = k
        call stat_assign( var_index=stats_metadata%ivpwp_mfl, var_name="vpwp_mfl", &
             var_description="v'w'_mfl, vpwp budget: vpwp monotonic flux limiter", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vpwp_cl')
        stats_metadata%ivpwp_cl = k
        call stat_assign( var_index=stats_metadata%ivpwp_cl, var_name="vpwp_cl", &
             var_description="v'w'_cl, vpwp budget: vpwp clipping term", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

        ! Variance budgets
      case ('rtp2_bt')
        stats_metadata%irtp2_bt = k
        call stat_assign( var_index=stats_metadata%irtp2_bt, var_name="rtp2_bt", &
             var_description="rt'^2_bt, rt'2 budget: rtp2 time tendency", &
             var_units="(kg^2)/(kg^2 s)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('rtp2_ma')
        stats_metadata%irtp2_ma = k
        call stat_assign( var_index=stats_metadata%irtp2_ma, var_name="rtp2_ma", &
             var_description="rt'^2_ma, rtp2 budget: rtp2 mean advection", &
             var_units="(kg^2)/(kg^2 s)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('rtp2_ta')
        stats_metadata%irtp2_ta = k
        call stat_assign( var_index=stats_metadata%irtp2_ta, var_name="rtp2_ta", &
             var_description="rt'^2_ta, rtp2 budget: rtp2 turbulent advection", &
             var_units="(kg^2)/(kg^2 s)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('rtp2_tp')
        stats_metadata%irtp2_tp = k
        call stat_assign( var_index=stats_metadata%irtp2_tp, var_name="rtp2_tp", &
             var_description="rt'^2_tp, rtp2 budget: rtp2 turbulent production", &
             var_units="(kg^2)/(kg^2 s)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('rtp2_dp1')
        stats_metadata%irtp2_dp1 = k
        call stat_assign( var_index=stats_metadata%irtp2_dp1, var_name="rtp2_dp1", &
             var_description="rt'^2_dp1, rtp2 budget: rtp2 dissipation term 1", &
             var_units="(kg^2)/(kg^2 s)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('rtp2_dp2')
        stats_metadata%irtp2_dp2 = k
        call stat_assign( var_index=stats_metadata%irtp2_dp2, var_name="rtp2_dp2", &
             var_description="rt'^2_dp2, rtp2 budget: rtp2 dissipation term 2", &
             var_units="(kg^2)/(kg^2 s)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('rtp2_cl')
        stats_metadata%irtp2_cl = k
        call stat_assign( var_index=stats_metadata%irtp2_cl, var_name="rtp2_cl", &
             var_description="rt'^2_cl, rtp2 budget: rtp2 clipping term", &
             var_units="(kg^2)/(kg^2 s)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('rtp2_pd')
        stats_metadata%irtp2_pd = k
        call stat_assign( var_index=stats_metadata%irtp2_pd, var_name="rtp2_pd", &
             var_description="rt'^2_pd, rtp2 budget: rtp2 positive definite adjustment", &
             var_units="(kg^2)/(kg^2 s)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('rtp2_sf')
        stats_metadata%irtp2_sf = k
        call stat_assign( var_index=stats_metadata%irtp2_sf, var_name="rtp2_sf", &
             var_description="rt'^2_sf, rtp2 budget: rtp2 surface variance", &
             var_units="(kg^2)/(kg^2 s)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('rtp2_forcing')
        stats_metadata%irtp2_forcing = k

        call stat_assign( var_index=stats_metadata%irtp2_forcing, var_name="rtp2_forcing", &
             var_description="rt'^2_forcing, rtp2 budget: rtp2 forcing " &
             // "(includes microphysics tendency)", &
             var_units="(kg/kg)^2/s", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('rtp2_mc')
        stats_metadata%irtp2_mc = k

        call stat_assign( var_index=stats_metadata%irtp2_mc, var_name="rtp2_mc", &
             var_description="rt'^2_mc, Microphysics tendency for rtp2 (not in budget)", &
             var_units="(kg/kg)^2/s", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('thlp2_bt')
        stats_metadata%ithlp2_bt = k
        call stat_assign( var_index=stats_metadata%ithlp2_bt, var_name="thlp2_bt", &
             var_description="thl'^2_bt, thlp2 budget: thlp2 time tendency", &
             var_units="(K^2)/s", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('thlp2_ma')
        stats_metadata%ithlp2_ma = k
        call stat_assign( var_index=stats_metadata%ithlp2_ma, var_name="thlp2_ma", &
             var_description="thl'^2_ma, thlp2 budget: thlp2 mean advection", &
             var_units="(K^2)/s", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('thlp2_ta')
        stats_metadata%ithlp2_ta = k
        call stat_assign( var_index=stats_metadata%ithlp2_ta, var_name="thlp2_ta", &
             var_description="thl'^2_ta, thlp2 budget: thlp2 turbulent advection", &
             var_units="(K^2)/s", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('thlp2_tp')
        stats_metadata%ithlp2_tp = k
        call stat_assign( var_index=stats_metadata%ithlp2_tp, var_name="thlp2_tp", &
             var_description="thl'^2_t', thlp2 budget: thlp2 turbulent production", &
             var_units="(K^2)/s", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('thlp2_dp1')
        stats_metadata%ithlp2_dp1 = k
        call stat_assign( var_index=stats_metadata%ithlp2_dp1, var_name="thlp2_dp1", &
             var_description="thl'^2_dp1, thlp2 budget: thlp2 dissipation term 1", &
             var_units="(K^2)/s", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('thlp2_dp2')
        stats_metadata%ithlp2_dp2 = k
        call stat_assign( var_index=stats_metadata%ithlp2_dp2, var_name="thlp2_dp2", &
             var_description="thl'^2_dp2, thlp2 budget: thlp2 dissipation term 2", &
             var_units="(K^2)/s", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('thlp2_cl')
        stats_metadata%ithlp2_cl = k
        call stat_assign( var_index=stats_metadata%ithlp2_cl, var_name="thlp2_cl", &
             var_description="thl'^2_cl, thlp2 budget: thlp2 clipping term", &
             var_units="(K^2)/s", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('thlp2_pd')
        stats_metadata%ithlp2_pd = k
        call stat_assign( var_index=stats_metadata%ithlp2_pd, var_name="thlp2_pd", &
             var_description="thl'^2_pd, thlp2 budget: thlp2 positive definite adjustment", &
             var_units="K^2/s", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('thlp2_sf')
        stats_metadata%ithlp2_sf = k
        call stat_assign( var_index=stats_metadata%ithlp2_sf, var_name="thlp2_sf", &
             var_description="thl'^2_sf, thl'^2 budget: thlp2 surface variance", &
             var_units="K^2/s", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('thlp2_forcing')
        stats_metadata%ithlp2_forcing = k
        call stat_assign( var_index=stats_metadata%ithlp2_forcing, var_name="thlp2_forcing", &
             var_description="thlp2 budget: thlp2 forcing (includes microphysics tendency) &
             &[K^2/s]", &
             var_units="K^2/s", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('thlp2_mc')
        stats_metadata%ithlp2_mc = k
        call stat_assign( var_index=stats_metadata%ithlp2_mc, var_name="thlp2_mc", &
             var_description="thl'^2_mc, Microphysics tendency for thlp2 (not in budget)", &
             var_units="K^2/s", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('rtpthlp_bt')
        stats_metadata%irtpthlp_bt = k
        call stat_assign( var_index=stats_metadata%irtpthlp_bt, var_name="rtpthlp_bt", &
             var_description="rt'thl'_bt, rtpthlp budget: rtpthlp time tendency", &
             var_units="(kg K)/(kg s)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('rtpthlp_ma')
        stats_metadata%irtpthlp_ma = k
        call stat_assign( var_index=stats_metadata%irtpthlp_ma, var_name="rtpthlp_ma", &
             var_description="rt'thl'_ma, rtpthlp budget: rtpthlp mean advection", &
             var_units="(kg K)/(kg s)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('rtpthlp_ta')
        stats_metadata%irtpthlp_ta = k
        call stat_assign( var_index=stats_metadata%irtpthlp_ta, var_name="rtpthlp_ta", &
             var_description="rt'thl'_ta, rtpthlp budget: rtpthlp turbulent advection", &
             var_units="(kg K)/(kg s)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('rtpthlp_tp1')
        stats_metadata%irtpthlp_tp1 = k
        call stat_assign( var_index=stats_metadata%irtpthlp_tp1, var_name="rtpthlp_tp1", &
             var_description="rt'thl'_tp1, rtpthlp budget: rtpthlp turbulent production 1", &
             var_units="(kg K)/(kg s)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('rtpthlp_tp2')
        stats_metadata%irtpthlp_tp2 = k
        call stat_assign( var_index=stats_metadata%irtpthlp_tp2, var_name="rtpthlp_tp2", &
             var_description="rt'thl'_t'^2, rtpthlp budget: rtpthlp turbulent production 2", &
             var_units="(kg K)/(kg s)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('rtpthlp_dp1')
        stats_metadata%irtpthlp_dp1 = k
        call stat_assign( var_index=stats_metadata%irtpthlp_dp1, var_name="rtpthlp_dp1", &
             var_description="rt'thl'_d'1, rtpthlp budget: rtpthlp dissipation term 1", &
             var_units="(kg K)/(kg s)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('rtpthlp_dp2')
        stats_metadata%irtpthlp_dp2 = k
        call stat_assign( var_index=stats_metadata%irtpthlp_dp2, var_name="rtpthlp_dp2", &
             var_description="rt'thl'_dp2, rtpthlp budget: rtpthlp dissipation term 2", &
             var_units="(kg K)/(kg s)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('rtpthlp_cl')
        stats_metadata%irtpthlp_cl = k
        call stat_assign( var_index=stats_metadata%irtpthlp_cl, var_name="rtpthlp_cl", &
             var_description="rt'thl'_cl, rtpthlp budget: rtpthlp clipping term", &
             var_units="(kg K)/(kg s)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('rtpthlp_sf')
        stats_metadata%irtpthlp_sf = k
        call stat_assign( var_index=stats_metadata%irtpthlp_sf, var_name="rtpthlp_sf", &
             var_description="rt'thl'_sf, rtpthlp budget: rtpthlp surface variance", &
             var_units="(kg K)/(kg s)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('rtpthlp_forcing')
        stats_metadata%irtpthlp_forcing = k
        call stat_assign( var_index=stats_metadata%irtpthlp_forcing, var_name="rtpthlp_forcing", &
             var_description="rt'thl'_forcing, rtpthlp budget: rtpthlp forcing "&
             // "(includes microphysics tendency)", &
             var_units="(K kg/kg)/s", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1
      case ('rtpthlp_mc')
        stats_metadata%irtpthlp_mc = k
        call stat_assign( var_index=stats_metadata%irtpthlp_mc, var_name="rtpthlp_mc", &
             var_description="rt'thl'_mc, Microphysics tendency for rtpthlp (not in budget)", &
             var_units="(K kg/kg)/s", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('up2')
        stats_metadata%iup2 = k
        call stat_assign( var_index=stats_metadata%iup2, var_name="up2", &
             var_description="u'^2, Variance of eastward (u) wind", var_units="m^2/s^2", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vp2')
        stats_metadata%ivp2 = k
        call stat_assign( var_index=stats_metadata%ivp2, var_name="vp2", &
             var_description="v'^2, Variance of northward (v) wind", var_units="m^2/s^2", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('up2_bt')
        stats_metadata%iup2_bt = k
        call stat_assign( var_index=stats_metadata%iup2_bt, var_name="up2_bt", &
             var_description="u'^2_bt, up2 budget: up2 time tendency", var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('up2_ma')
        stats_metadata%iup2_ma = k
        call stat_assign( var_index=stats_metadata%iup2_ma, var_name="up2_ma", &
             var_description="u'^2_ma, up2 budget: up2 mean advection", var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('up2_ta')
        stats_metadata%iup2_ta = k
        call stat_assign( var_index=stats_metadata%iup2_ta, var_name="up2_ta", &
             var_description="u'^2_ta, up2 budget: up2 turbulent advection", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('up2_tp')
        stats_metadata%iup2_tp = k
        call stat_assign( var_index=stats_metadata%iup2_tp, var_name="up2_tp", &
             var_description="u'^2_tp, up2 budget: up2 turbulent production", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('up2_dp1')
        stats_metadata%iup2_dp1 = k
        call stat_assign( var_index=stats_metadata%iup2_dp1, var_name="up2_dp1", &
             var_description="u'^2_dp1, up2 budget: up2 dissipation term 1", &
             var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('up2_dp2')
        stats_metadata%iup2_dp2 = k
        call stat_assign( var_index=stats_metadata%iup2_dp2, var_name="up2_dp2", &
             var_description="u'^2_d'^2, up2 budget: up2 dissipation term 2", &
             var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('up2_pr1')
        stats_metadata%iup2_pr1 = k
        call stat_assign( var_index=stats_metadata%iup2_pr1, var_name="up2_pr1", &
             var_description="u'^2_pr1, up2 budget: up2 pressure term 1", var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('up2_pr2')
        stats_metadata%iup2_pr2 = k
        call stat_assign( var_index=stats_metadata%iup2_pr2, var_name="up2_pr2", &
             var_description="u'^2_pr2, up2 budget: up2 pressure term 2", var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('up2_sdmp')
        stats_metadata%iup2_sdmp = k
        call stat_assign( var_index=stats_metadata%iup2_sdmp, var_name="up2_sdmp", &
             var_description="u'^2_sdmp, up2 budget: up2 sponge damping term", &
             var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('up2_cl')
        stats_metadata%iup2_cl = k
        call stat_assign( var_index=stats_metadata%iup2_cl, var_name="up2_cl", &
             var_description="u'^2_cl, up2 budget: up2 clipping", var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('up2_pd')
        stats_metadata%iup2_pd = k
        call stat_assign( var_index=stats_metadata%iup2_pd, var_name="up2_pd", &
             var_description="u'^2_pd, up2 budget: up2 positive definite adjustment", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('up2_sf')
        stats_metadata%iup2_sf = k
        call stat_assign( var_index=stats_metadata%iup2_sf, var_name="up2_sf", &
             var_description="u'^2_sf, up2 budget: up2 surface variance", var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('up2_splat')
        stats_metadata%iup2_splat = k
        call stat_assign( var_index=stats_metadata%iup2_splat, var_name="up2_splat", &
             var_description="u'^2_splat, up2 budget: up2 splatting", var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vp2_bt')
        stats_metadata%ivp2_bt = k
        call stat_assign( var_index=stats_metadata%ivp2_bt, var_name="vp2_bt", &
             var_description="v'2_bt, vp2 budget: vp2 time tendency", var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vp2_ma')
        stats_metadata%ivp2_ma = k
        call stat_assign( var_index=stats_metadata%ivp2_ma, var_name="vp2_ma", &
             var_description="v'^2_ma, vp2 budget: vp2 mean advection", var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vp2_ta')
        stats_metadata%ivp2_ta = k
        call stat_assign( var_index=stats_metadata%ivp2_ta, var_name="vp2_ta", &
             var_description="v'^2_ta, vp2 budget: vp2 turbulent advection", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vp2_tp')
        stats_metadata%ivp2_tp = k
        call stat_assign( var_index=stats_metadata%ivp2_tp, var_name="vp2_tp", &
             var_description="v'^2_tp, vp2 budget: vp2 turbulent production", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vp2_dp1')
        stats_metadata%ivp2_dp1 = k
        call stat_assign( var_index=stats_metadata%ivp2_dp1, var_name="vp2_dp1", &
             var_description="v'^2_dp1, vp2 budget: vp2 dissipation term 1", &
             var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vp2_dp2')
        stats_metadata%ivp2_dp2 = k
        call stat_assign( var_index=stats_metadata%ivp2_dp2, var_name="vp2_dp2", &
             var_description="v'^2_dp2, vp2 budget: vp2 dissipation term 2", &
             var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vp2_pr1')
        stats_metadata%ivp2_pr1 = k
        call stat_assign( var_index=stats_metadata%ivp2_pr1, var_name="vp2_pr1", &
             var_description="v'^2_pr1, vp2 budget: vp2 pressure term 1", var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vp2_pr2')
        stats_metadata%ivp2_pr2 = k
        call stat_assign( var_index=stats_metadata%ivp2_pr2, var_name="vp2_pr2", &
             var_description="v'^2_pr2, vp2 budget: vp2 pressure term 2", var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vp2_sdmp')
        stats_metadata%ivp2_sdmp = k
        call stat_assign( var_index=stats_metadata%ivp2_sdmp, var_name="vp2_sdmp", &
             var_description="v'^2_sdmp, vp2 budget: vp2 sponge damping term", &
             var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vp2_cl')
        stats_metadata%ivp2_cl = k
        call stat_assign( var_index=stats_metadata%ivp2_cl, var_name="vp2_cl", &
             var_description="v'^2_cl, vp2 budget: vp2 clipping", var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vp2_pd')
        stats_metadata%ivp2_pd = k
        call stat_assign( var_index=stats_metadata%ivp2_pd, var_name="vp2_pd", &
             var_description="v'^2_pd, vp2 budget: vp2 positive definite adjustment", &
             var_units="m^2/s^3", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vp2_sf')
        stats_metadata%ivp2_sf = k
        call stat_assign( var_index=stats_metadata%ivp2_sf, var_name="vp2_sf", &
             var_description="v'^2_sf, vp2 budget: vp2 surface variance", var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('vp2_splat')
        stats_metadata%ivp2_splat = k
        call stat_assign( var_index=stats_metadata%ivp2_splat, var_name="vp2_splat", &
             var_description="v'^2_splat, vp2 budget: vp2 splatting", var_units="m^2/s^3", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wpthlp_enter_mfl')
        stats_metadata%iwpthlp_enter_mfl = k
        call stat_assign( var_index=stats_metadata%iwpthlp_enter_mfl, var_name="wpthlp_enter_mfl", &
             var_description="w'thl'_enter_mfl, Wpthlp entering flux limiter", &
             var_units="(m K)/s", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wpthlp_exit_mfl')
        stats_metadata%iwpthlp_exit_mfl = k
        call stat_assign( var_index=stats_metadata%iwpthlp_exit_mfl, var_name="wpthlp_exit_mfl", &
             var_description="w'thl'_exit_mfl, Wpthlp exiting flux limiter", &
             var_units="(m K)/s", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wpthlp_mfl_min')
        stats_metadata%iwpthlp_mfl_min = k
        call stat_assign( var_index=stats_metadata%iwpthlp_mfl_min, var_name="wpthlp_mfl_min", &
             var_description="w'thl'_mfl_min, Minimum allowable wpthlp", var_units="(m K)/s", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wpthlp_mfl_max')
        stats_metadata%iwpthlp_mfl_max = k
        call stat_assign( var_index=stats_metadata%iwpthlp_mfl_max, var_name="wpthlp_mfl_max", &
             var_description="w'thl'_mfl_max, Maximum allowable wpthlp", var_units="(m K)/s", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wprtp_mfl_min')
        stats_metadata%iwprtp_mfl_min = k
        call stat_assign( var_index=stats_metadata%iwprtp_mfl_min, var_name="wprtp_mfl_min", &
             var_description="w'rt'_mfl_min, Minimum allowable wprtp", &
             var_units="(m kg)/(s kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wprtp_mfl_max')
        stats_metadata%iwprtp_mfl_max = k
        call stat_assign( var_index=stats_metadata%iwprtp_mfl_max, var_name="wprtp_mfl_max", &
             var_description="w'rt'_mfl_max, Maximum allowable wprtp", &
             var_units="(m kg)/(s kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wprtp_enter_mfl')
        stats_metadata%iwprtp_enter_mfl = k
        call stat_assign( var_index=stats_metadata%iwprtp_enter_mfl, var_name="wprtp_enter_mfl", &
             var_description="w'rt'_enter_mfl, Wprtp entering flux limiter", &
             var_units="(m kg)/(s kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wprtp_exit_mfl')
        stats_metadata%iwprtp_exit_mfl = k
        call stat_assign( var_index=stats_metadata%iwprtp_exit_mfl, var_name="wprtp_exit_mfl", &
             var_description="w'rt'_exit_mfl, Wprtp exiting flux limiter", &
             var_units="(m kg)/(s kg)", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('wm_zm')
        stats_metadata%iwm_zm = k
        call stat_assign( var_index=stats_metadata%iwm_zm, var_name="wm_zm", &
             var_description="wm_zm, Vertical (w) wind", var_units="m/s", l_silhs=.false., &
             grid_kind=stats_zm )
        k = k + 1

      case ('cloud_frac_zm')
        stats_metadata%icloud_frac_zm = k
        call stat_assign( var_index=stats_metadata%icloud_frac_zm, var_name="cloud_frac_zm", &
          var_description="cloud_frac_zm, Cloud fraction", &
          var_units="-", l_silhs=.false., grid_kind=stats_zm)
        k = k + 1

      case ('ice_supersat_frac_zm')
        stats_metadata%iice_supersat_frac_zm = k
        call stat_assign( var_index=stats_metadata%iice_supersat_frac_zm, var_name="ice_supersat_frac_zm", &
             var_description="ice_supersat_frac_zm, Ice cloud fraction", &
             var_units="count", l_silhs=.false., &
             grid_kind=stats_zm )
        k = k + 1

      case ('rcm_zm')
        stats_metadata%ircm_zm = k
        call stat_assign( var_index=stats_metadata%ircm_zm, var_name="rcm_zm", &
             var_description="rcm_zm, Total water mixing ratio", var_units="kg/kg", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('rtm_zm')
        stats_metadata%irtm_zm = k
        call stat_assign( var_index=stats_metadata%irtm_zm, var_name="rtm_zm", &
             var_description="rtm_zm, Total water mixing ratio", var_units="kg/kg", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('thlm_zm')
        stats_metadata%ithlm_zm = k
        call stat_assign( var_index=stats_metadata%ithlm_zm, var_name="thlm_zm", &
             var_description="thlm_zm, Liquid potential temperature", &
             var_units="K", l_silhs=.false., &
             grid_kind=stats_zm )
        k = k + 1

      case ('w_1_zm')
        stats_metadata%iw_1_zm = k
        call stat_assign( var_index=stats_metadata%iw_1_zm, var_name="w_1_zm", &
             var_description="w_1_zm, pdf parameter zm: mean w of component 1", &
             var_units="m/s", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('w_2_zm')
        stats_metadata%iw_2_zm = k
        call stat_assign( var_index=stats_metadata%iw_2_zm, var_name="w_2_zm", &
             var_description="w_2_zm, pdf parameter zm: mean w of component 2", &
             var_units="m/s", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('varnce_w_1_zm')
        stats_metadata%ivarnce_w_1_zm = k
        call stat_assign( var_index=stats_metadata%ivarnce_w_1_zm, var_name="varnce_w_1_zm", &
             var_description="varnce_w_1_zm, pdf parameter zm: w variance of component 1", &
             var_units="m^2/s^2", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('varnce_w_2_zm')
        stats_metadata%ivarnce_w_2_zm = k
        call stat_assign( var_index=stats_metadata%ivarnce_w_2_zm, var_name="varnce_w_2_zm", &
             var_description="varnce_w_2_zm, pdf parameter zm: w variance of component 2", &
             var_units="m^2/s^2", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ('mixt_frac_zm')
        stats_metadata%imixt_frac_zm = k
        call stat_assign( var_index=stats_metadata%imixt_frac_zm, var_name="mixt_frac_zm", &
             var_description="mixt_frac_zm, pdf parameter zm: mixture fraction", &
             var_units="-", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'Skw_velocity' )
        stats_metadata%iSkw_velocity = k
        call stat_assign( var_index=stats_metadata%iSkw_velocity, var_name="Skw_velocity", &
             var_description="Skw_velocity, Skewness velocity", &
             var_units="m/s", l_silhs=.false., &
             grid_kind=stats_zm )
        k = k + 1

      case ( 'gamma_Skw_fnc' )
        stats_metadata%igamma_Skw_fnc = k
        call stat_assign( var_index=stats_metadata%igamma_Skw_fnc, var_name="gamma_Skw_fnc", &
             var_description="gamma_Skw_fnc, Gamma as a function of skewness", var_units="-", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'C6rt_Skw_fnc' )
        stats_metadata%iC6rt_Skw_fnc = k
        call stat_assign( var_index=stats_metadata%iC6rt_Skw_fnc, var_name="C6rt_Skw_fnc", &
             var_description="C6rt_Skw_fnc, C_6rt parameter with Sk_w applied", var_units="-", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'C6thl_Skw_fnc' )
        stats_metadata%iC6thl_Skw_fnc = k
        call stat_assign( var_index=stats_metadata%iC6thl_Skw_fnc, var_name="C6thl_Skw_fnc", &
             var_description="C6thl_Skw_fnc, C_6thl parameter with Sk_w applied", var_units="-", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'C6_term' )
        stats_metadata%iC6_term = k
        call stat_assign( var_index=stats_metadata%iC6_term, var_name="C6_term", &
             var_description="C6 term [-]", var_units="-", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'C7_Skw_fnc' )
        stats_metadata%iC7_Skw_fnc = k
        call stat_assign( var_index=stats_metadata%iC7_Skw_fnc, var_name="C7_Skw_fnc", &
             var_description="C7_Skw_fnc, C_7 parameter with Sk_w applied", var_units="-", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'C1_Skw_fnc' )
        stats_metadata%iC1_Skw_fnc = k
        call stat_assign( var_index=stats_metadata%iC1_Skw_fnc, var_name="C1_Skw_fnc", &
             var_description="C1_Skw_fnc, C_1 parameter with Sk_w applied", var_units="-", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'coef_wp4_implicit' )
        stats_metadata%icoef_wp4_implicit = k
        call stat_assign( var_index=stats_metadata%icoef_wp4_implicit, &
                          var_name="coef_wp4_implicit", &
                          var_description="coef_wp4_implicit, wp4 = coef_wp4_implicit * wp2^2" &
                                          // " (new PDF)", &
                          var_units="-", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'bv_freq_sqd' )
        stats_metadata%ibrunt_vaisala_freq_sqd = k
        call stat_assign( var_index=stats_metadata%ibrunt_vaisala_freq_sqd, var_name="bv_freq_sqd", &
             var_description="Brunt-Vaisala frequency squared", &
             var_units="1/s^2", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'bv_freq_sqd_splat' )
        stats_metadata%ibrunt_vaisala_freq_sqd_splat = k
        call stat_assign( var_index=stats_metadata%ibrunt_vaisala_freq_sqd_splat, var_name="bv_freq_sqd_splat", &
             var_description="Brunt-Vaisala freq. squared for splatting", &
             var_units="1/s^2", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'bv_freq_sqd_mixed' )
        stats_metadata%ibrunt_vaisala_freq_sqd_mixed = k
        call stat_assign( var_index=stats_metadata%ibrunt_vaisala_freq_sqd_mixed, var_name="bv_freq_sqd_mixed", &
             var_description="Interpolated Brunt-Vaisala freq. squared between moist and dry air", &
             var_units="1/s^2", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'bv_freq_sqd_moist' )
        stats_metadata%ibrunt_vaisala_freq_sqd_moist = k
        call stat_assign( var_index=stats_metadata%ibrunt_vaisala_freq_sqd_moist, var_name="bv_freq_sqd_moist", &
             var_description="Brunt-Vaisala freq. squared in moist air", &
             var_units="1/s^2", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'bv_freq_sqd_dry' )
        stats_metadata%ibrunt_vaisala_freq_sqd_dry = k
        call stat_assign( var_index=stats_metadata%ibrunt_vaisala_freq_sqd_dry, var_name="bv_freq_sqd_dry", &
             var_description="Brunt-Vaisala freq. squared in dry air", &
             var_units="1/s^2", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'Ri_zm' )
        stats_metadata%iRi_zm = k
        call stat_assign( var_index=stats_metadata%iRi_zm,var_name="Ri_zm", &
             var_description="Richardson number [-]", var_units="-", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'shear_sqd' )
        stats_metadata%ishear_sqd = k
        call stat_assign( var_index=stats_metadata%ishear_sqd, var_name="shear_sqd", &
             var_description="shear_sqd, shear_sqd", var_units="-", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'a3_coef' )
        stats_metadata%ia3_coef = k
        call stat_assign( var_index=stats_metadata%ia3_coef, var_name="a3_coef", &
             var_description="a3_coef, Quantity in formula 25 from Equations for CLUBB", &
             var_units="count", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'wp3_on_wp2' )
        stats_metadata%iwp3_on_wp2 = k
        call stat_assign( var_index=stats_metadata%iwp3_on_wp2, var_name="wp3_on_wp2", &
             var_description="w'^3_on_w'^2, Smoothed version of wp3 / wp2", var_units="m/s", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'wp3_on_wp2_cfl_num' )
        stats_metadata%iwp3_on_wp2_cfl_num = k
        call stat_assign( var_index=stats_metadata%iwp3_on_wp2_cfl_num, var_name="wp3_on_wp2_cfl_num", &
             var_description="w'^3_on_w'^2 CFL number", var_units="-", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'Skw_zm' )
        stats_metadata%iSkw_zm = k
        call stat_assign( var_index=stats_metadata%iSkw_zm, var_name="Skw_zm", &
             var_description="Skw_zm, Skewness of w on momentum levels", var_units="-", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'Skthl_zm' )
        stats_metadata%iSkthl_zm = k
        call stat_assign( var_index=stats_metadata%iSkthl_zm, var_name="Skthl_zm", &
             var_description="Skthl_zm, Skewness of thl on momentum levels", var_units="-", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'Skrt_zm' )
        stats_metadata%iSkrt_zm = k
        call stat_assign( var_index=stats_metadata%iSkrt_zm, var_name="Skrt_zm", &
             var_description="Skrt_zm, Skewness of rt on momentum levels", var_units="-", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'stability_correction' )
        stats_metadata%istability_correction = k
        call stat_assign( var_index=stats_metadata%istability_correction, var_name="stability_correction", &
             var_description="stability_correction, Stability applied to "&
             // "diffusion of rtm and thlm", var_units="-", &
             l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'rtp2_from_chi' )
        stats_metadata%irtp2_from_chi = k
        call stat_assign( var_index=stats_metadata%irtp2_from_chi, var_name="rtp2_from_chi", &
             var_description="rtp2_from_chi, Variance of rt, computed from the " &
             // "chi/eta distribution", &
             var_units="(kg/kg)^2", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'lh_rtp2_mc' )
        stats_metadata%ilh_rtp2_mc = k
        call stat_assign( var_index=stats_metadata%ilh_rtp2_mc, var_name="lh_rtp2_mc", &
             var_description="lh_rtp2_mc, LH est. of rtp2_mc", &
             var_units="(kg/kg)^2/s", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'lh_thlp2_mc' )
        stats_metadata%ilh_thlp2_mc = k
        call stat_assign( var_index=stats_metadata%ilh_thlp2_mc, var_name="lh_thlp2_mc", &
             var_description="lh_thl'^2_mc, LH est. of thlp2_mc", &
             var_units="K^2/s", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'lh_wprtp_mc' )
        stats_metadata%ilh_wprtp_mc = k
        call stat_assign( var_index=stats_metadata%ilh_wprtp_mc, var_name="lh_wprtp_mc", &
             var_description="lh_w'rt'_mc, LH est. of wprtp_mc", &
             var_units="(m kg/kg)/s^2", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'lh_wpthlp_mc' )
        stats_metadata%ilh_wpthlp_mc = k
        call stat_assign( var_index=stats_metadata%ilh_wpthlp_mc, var_name="lh_wpthlp_mc", &
             var_description="lh_w'thl'_mc, LH est. of wpthlp_mc", &
             var_units="(m K)/s^2", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'lh_rtpthlp_mc' )
        stats_metadata%ilh_rtpthlp_mc = k
        call stat_assign( var_index=stats_metadata%ilh_rtpthlp_mc, var_name="lh_rtpthlp_mc", &
             var_description="lh_rt'thl'_mc, LH est. of rtpthlp_mc", &
             var_units="(K kg/kg)/s", l_silhs=.false., grid_kind=stats_zm )
        k = k + 1

      case ( 'sclrprtp' )
        do j = 1, sclr_dim, 1
          write( sclr_idx, * ) j
          sclr_idx = adjustl(sclr_idx)
          stats_metadata%isclrprtp(j) = k
          call stat_assign( var_index=stats_metadata%isclrprtp(j), var_name="sclr"//trim(sclr_idx)//"prtp", &
            var_description="scalar("//trim(sclr_idx)//")'rt'", var_units="unknown", &
            l_silhs=.false., grid_kind=stats_zm )
          k = k + 1
        end do

      case ( 'sclrp2' )
        do j = 1, sclr_dim, 1
          write( sclr_idx, * ) j
          sclr_idx = adjustl(sclr_idx)
          stats_metadata%isclrp2(j) = k
          call stat_assign( var_index=stats_metadata%isclrp2(j), var_name="sclr"//trim(sclr_idx)//"p2", &
            var_description="scalar("//trim(sclr_idx)//")'^2'", var_units="unknown", &
            l_silhs=.false., grid_kind=stats_zm )
          k = k + 1
        end do

      case ( 'sclrpthvp' )
        do j = 1, sclr_dim, 1
          write( sclr_idx, * ) j
          sclr_idx = adjustl(sclr_idx)
          stats_metadata%isclrpthvp(j) = k
          call stat_assign( var_index=stats_metadata%isclrpthvp(j), var_name="sclr"//trim(sclr_idx)//"pthvp", &
            var_description="scalar("//trim(sclr_idx)//")'th_v'", var_units="unknown", &
            l_silhs=.false., grid_kind=stats_zm )
          k = k + 1
        end do

      case ( 'sclrpthlp' )
        do j = 1, sclr_dim, 1
          write( sclr_idx, * ) j
          sclr_idx = adjustl(sclr_idx)
          stats_metadata%isclrpthlp(j) = k
          call stat_assign( var_index=stats_metadata%isclrpthlp(j), var_name="sclr"//trim(sclr_idx)//"pthlp", &
            var_description="scalar("//trim(sclr_idx)//")'th_l'", var_units="unknown", &
            l_silhs=.false., grid_kind=stats_zm )
          k = k + 1
        end do

      case ( 'sclrprcp' )
        do j = 1, sclr_dim, 1
          write( sclr_idx, * ) j
          sclr_idx = adjustl(sclr_idx)
          stats_metadata%isclrprcp(j) = k
          call stat_assign( var_index=stats_metadata%isclrprcp(j), var_name="sclr"//trim(sclr_idx)//"prcp", &
            var_description="scalar("//trim(sclr_idx)//")'rc'", var_units="unknown", &
            l_silhs=.false., grid_kind=stats_zm )
          k = k + 1
        end do

      case ( 'wpsclrp' )
        do j = 1, sclr_dim, 1
          write( sclr_idx, * ) j
          sclr_idx = adjustl(sclr_idx)
          stats_metadata%iwpsclrp(j) = k
          call stat_assign( var_index=stats_metadata%iwpsclrp(j), var_name="wpsclr"//trim(sclr_idx)//"p", &
            var_description="'w'scalar("//trim(sclr_idx)//")", var_units="unknown", &
            l_silhs=.false., grid_kind=stats_zm )
          k = k + 1
        end do

      case ( 'wpsclrp2' )
        do j = 1, sclr_dim, 1
          write( sclr_idx, * ) j
          sclr_idx = adjustl(sclr_idx)
          stats_metadata%iwpsclrp2(j) = k
          call stat_assign( var_index=stats_metadata%iwpsclrp2(j), var_name="wpsclr"//trim(sclr_idx)//"p2", &
            var_description="'w'scalar("//trim(sclr_idx)//")'^2'", var_units="unknown", &
            l_silhs=.false., grid_kind=stats_zm )
          k = k + 1
        end do

      case ( 'wp2sclrp' )
        do j = 1, sclr_dim, 1
          write( sclr_idx, * ) j
          sclr_idx = adjustl(sclr_idx)
          stats_metadata%iwp2sclrp(j) = k
          call stat_assign( var_index=stats_metadata%iwp2sclrp(j), var_name="wp2sclr"//trim(sclr_idx)//"p", &
            var_description="'w'^2 scalar("//trim(sclr_idx)//")", var_units="unknown", &
            l_silhs=.false., grid_kind=stats_zm )
          k = k + 1
        end do

      case ( 'wpsclrprtp' )
        do j = 1, sclr_dim, 1
          write( sclr_idx, * ) j
          sclr_idx = adjustl(sclr_idx)
          stats_metadata%iwpsclrprtp(j) = k
          call stat_assign( var_index=stats_metadata%iwpsclrprtp(j), var_name="wpsclr"//trim(sclr_idx)//"prtp", &
            var_description="'w' scalar("//trim(sclr_idx)//")'rt'", var_units="unknown", &
            l_silhs=.false., grid_kind=stats_zm )
          k = k + 1
        end do

      case ( 'wpsclrpthlp' )
        do j = 1, sclr_dim, 1
          write( sclr_idx, * ) j
          sclr_idx = adjustl(sclr_idx)
          stats_metadata%iwpsclrpthlp(j) = k
          call stat_assign( var_index=stats_metadata%iwpsclrpthlp(j), &
            var_name="wpsclr"//trim(sclr_idx)//"pthlp", &
            var_description="'w' scalar("//trim(sclr_idx)//")'th_l'", var_units="unknown", &
            l_silhs=.false., grid_kind=stats_zm )
          k = k + 1
        end do

      case ( 'wpedsclrp' )
        do j = 1, edsclr_dim, 1
          write( sclr_idx, * ) j
          sclr_idx = adjustl(sclr_idx)
          stats_metadata%iwpedsclrp(j) = k
          call stat_assign( var_index=stats_metadata%iwpedsclrp(j), var_name="wpedsclr"//trim(sclr_idx)//"p", &
            var_description="eddy scalar("//trim(sclr_idx)//")'w'", var_units="unknown", &
            l_silhs=.false., grid_kind=stats_zm )
          k = k + 1
        end do

      case default
        write(fstderr,*) 'Error:  unrecognized variable in vars_zm:  ',  trim(vars_zm(i))
        l_error = .true.  ! This will stop the run.

      end select

    end do ! i = 1 .. stats_zm%num_output_fields

    return
  end subroutine stats_init_zm

end module stats_zm_module
